<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="grosphi">





<title>APP-DiTingMotion-CFM | 胡思乱想</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 7.3.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const pagebody = document.getElementsByTagName('body')[0]

            function setTheme(status) {

                if (status === 'dark') {
                    window.sessionStorage.theme = 'dark'
                    pagebody.classList.add('dark-theme');

                } else if (status === 'light') {
                    window.sessionStorage.theme = 'light'
                    pagebody.classList.remove('dark-theme');
                }
            };

            setTheme(window.sessionStorage.theme)
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">火火的胡思乱想</a></div>
            <div class="menu navbar-right">
                
                <a class="menu-item" href="/archives">Posts</a>
                
                <a class="menu-item" href="/category">Categories</a>
                
                <a class="menu-item" href="/tag">Tags</a>
                
                <a class="menu-item" href="/about">About</a>
                
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">火火的胡思乱想</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">
                    <svg class="menu-icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M4.5 17.27q-.213 0-.356-.145T4 16.768t.144-.356t.356-.143h15q.213 0 .356.144q.144.144.144.357t-.144.356t-.356.143zm0-4.77q-.213 0-.356-.144T4 11.999t.144-.356t.356-.143h15q.213 0 .356.144t.144.357t-.144.356t-.356.143zm0-4.77q-.213 0-.356-.143Q4 7.443 4 7.23t.144-.356t.356-.143h15q.213 0 .356.144T20 7.23t-.144.356t-.356.144z"/></svg>
                    <svg class="close-icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><!-- Icon from Material Symbols Light by Google - https://github.com/google/material-design-icons/blob/master/LICENSE --><path fill="currentColor" d="m12 12.708l-5.246 5.246q-.14.14-.344.15t-.364-.15t-.16-.354t.16-.354L11.292 12L6.046 6.754q-.14-.14-.15-.344t.15-.364t.354-.16t.354.16L12 11.292l5.246-5.246q.14-.14.345-.15q.203-.01.363.15t.16.354t-.16.354L12.708 12l5.246 5.246q.14.14.15.345q.01.203-.15.363t-.354.16t-.354-.16z"/></svg>
                </div>
            </div>
            <div class="menu" id="mobile-menu">
                
                <a class="menu-item" href="/archives">Posts</a>
                
                <a class="menu-item" href="/category">Categories</a>
                
                <a class="menu-item" href="/tag">Tags</a>
                
                <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.classList.contains("active")) {
            toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        } else {
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // 为 6 时展开所有
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // 这个值是由 tocbot 源码里定义的 scrollSmoothDuration 得来的
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">APP-DiTingMotion-CFM</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">grosphi</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">八月 15, 2025&nbsp;&nbsp;18:08:15</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <div class="post-content">
            <h3 id="APP-Simultaneous-Seismic-Phase-Picking-and-Polarity-Determination-with-an-Attention-Based-Neural-Network"><a href="#APP-Simultaneous-Seismic-Phase-Picking-and-Polarity-Determination-with-an-Attention-Based-Neural-Network" class="headerlink" title="APP: Simultaneous Seismic Phase Picking and Polarity Determination with an Attention-Based Neural Network"></a>APP: Simultaneous Seismic Phase Picking and Polarity Determination with an Attention-Based Neural Network</h3><p><code>注意力机制</code></p>
<p>一、Summary</p>
<p>注意力机制是神经网络中主要层，用以确定P到时和极性，网络输入是一段Z分量波形（训练labels为P波到时的概率分布和P初动极性），输出就是labels，另外注意力机制所在层可以提供注意力map，可以看出网络的关注点在什么位置</p>
<p>二、训练数据（source： SCSN）</p>
<p>1、All data are associated with manually determined P-wave picks by SCSN analysts, which do not  include noise waveforms.</p>
<p>2、All data are demeaned, detrended, filtered (1–20 Hz), and normalized, and we select a 6s long time window centered on the P-wave arrival. </p>
<p>3、<strong>pretrain</strong></p>
<p><code>The model used in the pretraining is consistent with all parameters and training processing of the APP network, except that the classifier is set as a two-category problem, and only waveform data labeled polarities (up and down) are trained. We take the data for which manual labels are consistent with the prepredicted labels (probability &gt;0.9) as the relabeled data (Table S2), and then we use the relabeled data to train the APP network.</code></p>
<p>4、<strong>data augmentation</strong></p>
<p><code>(1) Time shifted (from −1 to 1 s, step is 0.1 s) is performed for the wave form centered on the P-wave arrival; (2) reversing the data to solve the problem of unbalanced polarities and increase the amount of the training dataset; and (3) stretching data are processed to expand the data to low frequency.</code></p>
<p>三、Network</p>
<p><img src="/../image/APP-DiTingMotion-CFM/image-20250814152455549.png" alt="image-20250814152455549"></p>
<p>Ⅱ的loss function（MSE）：<img src="/../image/APP-DiTingMotion-CFM/image-20250814154211501.png" alt="image-20250814154211501"></p>
<p>Ⅲ的loss function（cross entropy）：<img src="/../image/APP-DiTingMotion-CFM/image-20250814154231782.png" alt="image-20250814154231782"></p>
<p>四、 Results</p>
<p>包括SCSN，Hi-net，Oklahoma的数据，得出结论相似，这里仅以SCSN为例</p>
<img src="../image/APP-DiTingMotion-CFM/image-20250814155034916.png" alt="image-20250814155034916" style="zoom:67%;" />

<p><img src="/../image/APP-DiTingMotion-CFM/image-20250814154901755.png" alt="image-20250814154901755"></p>
<p>1、precision都比较高（为什么和RPNET那篇文章的不一样？），但是recall偏低，优于简单的CNN</p>
<p>2、图（a）为picking error，所有数据集测试的std都在0.05s附件，表现不错；极性的确定的正确率在98%以上，少量的错误不影响机制解的计算</p>
<p><img src="/../image/APP-DiTingMotion-CFM/image-20250814155450671.png" alt="image-20250814155450671"></p>
<p>3、疑问time-shift之后的结果貌似很好，这和RPNET（2025）的测试结果（time-shift仅仅0.5s就表现大幅下降）完全不同</p>
<p>4、随着the probability of P arrival picking的下降，极性预测的正确率会下降。If the probability of the P wave pick is too low, we should use a threshold to eliminate the results and avoid ambiguity.</p>
<p>五、 Discussion</p>
<p>1、从噪声效应、数据频率和事件幅度等不同方面进一步分析了APP模型的性能。 纯高斯噪声中，大约有1%的噪声数据被错误预测，其拾取P波的概率高于0.8，0.5%的噪声数据的极性被错误预测为向上或向下。由于错误结果的数量很少，我们得出结论，单独的噪声作为输入在统计上不应该对结果产生太大影响。</p>
<p>2、随着信噪比的增加，上下的召回率增加（图8c），未知量的精度和召回率降低，更多的未知极性被预测为上下（图8b，c）。</p>
<p><img src="/../image/APP-DiTingMotion-CFM/image-20250814161024028.png" alt="image-20250814161024028"></p>
<h3 id="DiTingMotion-A-deep-learning-first-motion-polarity-classifier-and-its-application-to-focal-mechanism-inversion"><a href="#DiTingMotion-A-deep-learning-first-motion-polarity-classifier-and-its-application-to-focal-mechanism-inversion" class="headerlink" title="DiTingMotion: A deep-learning first-motion-polarity classifier and its application to focal mechanism inversion"></a>DiTingMotion: A deep-learning first-motion-polarity classifier and its application to focal mechanism inversion</h3><p>一、Network &amp; Training</p>
<p><img src="/../image/APP-DiTingMotion-CFM/image-20250815145417532.png" alt="image-20250815145417532"></p>
<p>Network：</p>
<ol>
<li>综合后三个卷积层的输出作为汇总输出判定，这个结构（HED）（figure 1）最初设计用于检测物体边缘的精细特征，P波FMP确定中感兴趣的目标是P波到达周围的边缘特征</li>
<li>损失函数为local cross entropy（LCE），可以平衡各部分训练数据的权重，把容易分类的权重降低（LCE的训练时表现总比CE要好一点（figure 3））</li>
<li>输入额外加了个极性函数，相当于从<code>标注的到时</code>开始不考虑振幅只考虑极性（figure 2），<code>但是这一点使得神经网络对于time-shift的抗性不好</code>。从figure 6也可以看出来，尤其是-0.05s的部分</li>
</ol>
<p><img src="/../image/APP-DiTingMotion-CFM/image-20250815150756270.png" alt="image-20250815150756270"></p>
<p><img src="/../image/APP-DiTingMotion-CFM/image-20250815145438727.png" alt="image-20250815145438727"></p>
<p>Training：</p>
<ol>
<li>数据集：DiTing，SCSN(The DiTing dataset not only contains polarity information (“U”, “D”) but also includes the corresponding clarity instructions (“I”, “E”, and “x”). )</li>
<li>data augmentation: flips </li>
<li>result: figure 4</li>
</ol>
<p><img src="/../image/APP-DiTingMotion-CFM/image-20250815145447275.png" alt="image-20250815145447275"></p>
<p>二、Application to the 2019 ridgecrest earthquake sequence</p>
<p><img src="/../image/APP-DiTingMotion-CFM/image-20250815145334046.png" alt="image-20250815145334046"></p>
<p><strong>感觉这个网络不太行，最主要是不能对time-shift做出好的预测，实际上这是判断极性要考虑的问题，而不是要求phase-picking完全准确，至少0.05s的偏差需要接受</strong></p>
<h3 id="CFM-a-convolutional-neural-network-for-first-motion-polarity-classification-of-seismic-records-in-volcanic-and-tectonic-areas"><a href="#CFM-a-convolutional-neural-network-for-first-motion-polarity-classification-of-seismic-records-in-volcanic-and-tectonic-areas" class="headerlink" title="CFM : a  convolutional neural network for first-motion polarity classification of seismic records in volcanic and tectonic areas"></a>CFM : a  convolutional neural network for first-motion polarity classification of seismic records in volcanic and tectonic areas</h3><p>一、data</p>
<p>training：Instance</p>
<p>testing（added）：SCSN，Hi-net，……</p>
<p>二、<code>Data visualization with SOM and label noise</code></p>
<p>the Self Organizing Maps (SOM）：一种聚类（unsupervised machine learning）；使用到时的前0.2s和后0.05s作为输入（前0.2s是因为要包括noise，后0.05s是因为可以关注初动，而非二动……）</p>
<p>每个格点代表一个类cluster，其中的值代表label为极性向上的占比；其中&gt;99 or &lt;1的部分被认为的wrong labeled，经过检查符合猜想</p>
<p><img src="/../image/APP-DiTingMotion-CFM/image-20250815171516627.png" alt="image-20250815171516627"></p>
<p>三、数据处理和Network</p>
<ol>
<li>在到时前两秒和后0.05s做了一些从没见过的处理，不懂？<code>Specifically, we subtracted to each waveform the mean value of the noise, from 200 samples (2.0 s) before the corresponding P arrival time to 5 samples before (in order to not include in the value of the mean some unbalanced oscillations due to the seismic phase).</code></li>
<li>没有滤波</li>
<li>flip从而使向上和向下的数据量平衡</li>
<li>神经网络中的dropout是过拟合的一种手段，被作者解释为可以防止model学习到wrong labeled data</li>
</ol>
<p><img src="/../image/APP-DiTingMotion-CFM/image-20250815172216264.png" alt="image-20250815172216264"></p>
<p>四、results</p>
<p><img src="/../image/APP-DiTingMotion-CFM/image-20250815172252094.png" alt="image-20250815172252094"></p>
<p>关于time-shift的测试还是很明显的，训练时还是需要加上time-shift，对于testing中大于training中的time-shift的数据预测能力下降显著</p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>grosphi</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="http://example.com/2025/08/15/APP-DiTingMotion-CFM/">http://example.com/2025/08/15/APP-DiTingMotion-CFM/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>Do you believe in <strong>DESTINY</strong>?</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/deep-learning-polarity-determination-phase-picking/"># deep-learning, polarity-determination, phase-picking</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2025/10/14/EQTP-EQPolar-PoViT-UQ/">EQTP-EQPolar-PoViT-UQ</a>
            
            
            <a class="next" rel="next" href="/2025/08/11/RPNet%20Robust%20P-Wave%20First-Motion%20Polarity%20Determination%20Using%20Deep%20Learning/">RPNet--Robust P-Wave First-Motion Polarity Determination Using Deep Learning</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>© grosphi | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>

</html>